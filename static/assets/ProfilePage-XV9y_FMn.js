import{u as E,a as K,b as y,j as e}from"./query-CZD0ZRD-.js";import{r as x}from"./vendor-izpyVFLd.js";import{a as Y,c as d}from"./index-CJixA8aD.js";import{u as L,c as F,g as q}from"./userService-LCe-qciv.js";import{m as N,bf as R,C as H,U as P,f as C,d as O,o as Q,s as w,ac as k,O as G,P as I,aZ as V,p as _,aY as W,$ as Z}from"./ui-CAO-iScS.js";import"./charts-Db6Lds24.js";import"./api-Tqb-OO70.js";const $=[{key:"profile",label:"Profil Bilgileri",icon:P},{key:"security",label:"Güvenlik",icon:C},{key:"notifications",label:"Bildirim Tercihleri",icon:O}];function te(){var g,b,j,v;const{user:t,logout:S}=Y(),D=E(),[m,A]=x.useState("profile"),[i,h]=x.useState(!1),[z,f]=x.useState(!1),[r,u]=x.useState({first_name:(t==null?void 0:t.first_name)||"",last_name:(t==null?void 0:t.last_name)||"",phone:"",address:""}),[l,p]=x.useState({current_password:"",new_password:"",confirm_password:""}),{data:n,isLoading:J}=K({queryKey:["myProfile"],queryFn:q}),a=n||t;n&&r.first_name===""&&n.first_name&&u({first_name:n.first_name||"",last_name:n.last_name||"",phone:n.phone||"",address:n.address||""});const o=y({mutationFn:s=>L(s),onSuccess:()=>{D.invalidateQueries({queryKey:["myProfile"]}),h(!1)}}),c=y({mutationFn:s=>F(s),onSuccess:()=>{f(!1),p({current_password:"",new_password:"",confirm_password:""})}}),M=()=>{o.mutate(r)},T=()=>{if(l.new_password!==l.confirm_password){alert("Yeni şifreler eşleşmiyor");return}c.mutate({old_password:l.current_password,new_password:l.new_password})},X=()=>{S(),window.location.href="/login"};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Hesap Ayarları"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Profil bilgilerinizi ve hesap ayarlarınızı yönetin"})]}),e.jsx(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"card p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-24 h-24 rounded-full bg-primary/10 flex items-center justify-center overflow-hidden",children:a!=null&&a.avatar_url?e.jsx("img",{src:a.avatar_url,alt:"Avatar",className:"w-full h-full object-cover"}):e.jsxs("span",{className:"text-3xl font-bold text-primary",children:[(g=a==null?void 0:a.first_name)==null?void 0:g[0],(b=a==null?void 0:a.last_name)==null?void 0:b[0]]})}),e.jsx("button",{className:"absolute bottom-0 right-0 p-2 rounded-full bg-primary text-primary-foreground hover:bg-primary/90",children:e.jsx(R,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex-1 text-center md:text-left",children:[e.jsxs("h2",{className:"text-xl font-bold",children:[a==null?void 0:a.first_name," ",a==null?void 0:a.last_name]}),e.jsx("p",{className:"text-muted-foreground",children:a==null?void 0:a.email}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center md:justify-start gap-4 mt-3 text-sm text-muted-foreground",children:[e.jsx("span",{className:"badge badge-primary capitalize",children:a==null?void 0:a.role}),(a==null?void 0:a.created_at)&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(H,{className:"h-4 w-4"}),"Katılım: ",new Date(a.created_at).toLocaleDateString("tr-TR",{year:"numeric",month:"long"})]})]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx("button",{onClick:()=>h(!i),className:d("px-4 py-2 rounded-lg font-medium transition-colors",i?"bg-muted hover:bg-muted/80":"bg-primary text-primary-foreground hover:bg-primary/90"),children:i?"İptal":"Düzenle"})})]})}),e.jsxs("div",{className:"grid lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"card p-2 space-y-1",children:[$.map(s=>e.jsxs("button",{onClick:()=>A(s.key),className:d("w-full flex items-center gap-3 px-4 py-3 rounded-lg text-left transition-colors",m===s.key?"bg-primary text-primary-foreground":"hover:bg-muted"),children:[e.jsx(s.icon,{className:"h-5 w-5"}),s.label]},s.key)),e.jsx("hr",{className:"my-2"}),e.jsxs("button",{onClick:X,className:"w-full flex items-center gap-3 px-4 py-3 rounded-lg text-left text-destructive hover:bg-destructive/10",children:[e.jsx(Q,{className:"h-5 w-5"}),"Çıkış Yap"]})]})}),e.jsx("div",{className:"lg:col-span-3",children:e.jsxs(N.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"card p-6",children:[m==="profile"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Kişisel Bilgiler"}),o.isSuccess&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-green-50 text-green-700 rounded-lg",children:[e.jsx(w,{className:"h-5 w-5"}),"Profil başarıyla güncellendi"]}),o.isError&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-red-50 text-red-700 rounded-lg",children:[e.jsx(k,{className:"h-5 w-5"}),((j=o.error)==null?void 0:j.message)||"Bir hata oluştu"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"İsim"}),e.jsxs("div",{className:"relative",children:[e.jsx(P,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"}),e.jsx("input",{type:"text",value:r.first_name,onChange:s=>u({...r,first_name:s.target.value}),disabled:!i,className:d("w-full pl-10 pr-4 py-2 rounded-lg border bg-background","focus:outline-none focus:ring-2 focus:ring-primary/50","disabled:opacity-60 disabled:cursor-not-allowed")})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Soyisim"}),e.jsx("input",{type:"text",value:r.last_name,onChange:s=>u({...r,last_name:s.target.value}),disabled:!i,className:d("w-full px-4 py-2 rounded-lg border bg-background","focus:outline-none focus:ring-2 focus:ring-primary/50","disabled:opacity-60 disabled:cursor-not-allowed")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"E-posta"}),e.jsxs("div",{className:"relative",children:[e.jsx(G,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"}),e.jsx("input",{type:"email",defaultValue:a==null?void 0:a.email,disabled:!0,className:"w-full pl-10 pr-4 py-2 rounded-lg border bg-muted opacity-60 cursor-not-allowed"})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"E-posta değişikliği için destek ile iletişime geçin"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Telefon"}),e.jsxs("div",{className:"relative",children:[e.jsx(I,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"}),e.jsx("input",{type:"tel",value:r.phone,onChange:s=>u({...r,phone:s.target.value}),placeholder:"+90 5XX XXX XX XX",disabled:!i,className:d("w-full pl-10 pr-4 py-2 rounded-lg border bg-background","focus:outline-none focus:ring-2 focus:ring-primary/50","disabled:opacity-60 disabled:cursor-not-allowed")})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Adres"}),e.jsxs("div",{className:"relative",children:[e.jsx(V,{className:"absolute left-3 top-3 h-5 w-5 text-muted-foreground"}),e.jsx("textarea",{value:r.address,onChange:s=>u({...r,address:s.target.value}),placeholder:"Adresinizi girin",disabled:!i,rows:3,className:d("w-full pl-10 pr-4 py-2 rounded-lg border bg-background resize-none","focus:outline-none focus:ring-2 focus:ring-primary/50","disabled:opacity-60 disabled:cursor-not-allowed")})]})]})]}),i&&e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:M,disabled:o.isPending,className:d("flex items-center gap-2 px-6 py-2 rounded-lg font-medium","bg-primary text-primary-foreground hover:bg-primary/90","disabled:opacity-50"),children:[o.isPending?e.jsx(_,{className:"h-4 w-4 animate-spin"}):e.jsx(W,{className:"h-4 w-4"}),"Değişiklikleri Kaydet"]})})]}),m==="security"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Güvenlik Ayarları"}),c.isSuccess&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-green-50 text-green-700 rounded-lg",children:[e.jsx(w,{className:"h-5 w-5"}),"Şifre başarıyla değiştirildi"]}),c.isError&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-red-50 text-red-700 rounded-lg",children:[e.jsx(k,{className:"h-5 w-5"}),((v=c.error)==null?void 0:v.message)||"Şifre değiştirilemedi"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-4 border rounded-lg",children:z?e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium",children:"Şifre Değiştir"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"Mevcut Şifre"}),e.jsx("input",{type:"password",value:l.current_password,onChange:s=>p({...l,current_password:s.target.value}),className:"w-full px-4 py-2 rounded-lg border bg-background focus:outline-none focus:ring-2 focus:ring-primary/50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"Yeni Şifre"}),e.jsx("input",{type:"password",value:l.new_password,onChange:s=>p({...l,new_password:s.target.value}),className:"w-full px-4 py-2 rounded-lg border bg-background focus:outline-none focus:ring-2 focus:ring-primary/50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"Yeni Şifre (Tekrar)"}),e.jsx("input",{type:"password",value:l.confirm_password,onChange:s=>p({...l,confirm_password:s.target.value}),className:"w-full px-4 py-2 rounded-lg border bg-background focus:outline-none focus:ring-2 focus:ring-primary/50"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:T,disabled:c.isPending,className:"px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 disabled:opacity-50",children:c.isPending?e.jsx(_,{className:"h-4 w-4 animate-spin"}):"Şifreyi Değiştir"}),e.jsx("button",{onClick:()=>f(!1),className:"px-4 py-2 border rounded-lg hover:bg-muted",children:"İptal"})]})]}):e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Z,{className:"h-5 w-5 text-muted-foreground mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Şifre Değiştir"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Hesap güvenliği için şifrenizi düzenli olarak değiştirin"})]})]}),e.jsx("button",{onClick:()=>f(!0),className:"px-4 py-2 border rounded-lg hover:bg-muted",children:"Değiştir"})]})}),e.jsx("div",{className:"p-4 border rounded-lg",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(C,{className:"h-5 w-5 text-muted-foreground mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"İki Faktörlü Doğrulama"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Hesabınızı daha güvenli hale getirin"})]})]}),e.jsx("button",{className:"px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90",children:"Aktifleştir"})]})}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Aktif Oturumlar"}),e.jsx("div",{className:"space-y-3",children:[{device:"Windows - Chrome",location:"İstanbul, TR",current:!0},{device:"iPhone - Safari",location:"İstanbul, TR",current:!1}].map((s,B)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium",children:[s.device,s.current&&e.jsx("span",{className:"ml-2 badge badge-success",children:"Bu cihaz"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.location})]}),!s.current&&e.jsx("button",{className:"text-sm text-destructive hover:underline",children:"Sonlandır"})]},B))})]})]})]}),m==="notifications"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Bildirim Tercihleri"}),e.jsx("div",{className:"space-y-4",children:[{key:"email_course",label:"Kurs güncellemeleri",description:"Yeni içerik ve duyurular"},{key:"email_exam",label:"Sınav hatırlatmaları",description:"Yaklaşan sınavlar ve sonuçlar"},{key:"email_marketing",label:"Promosyonlar",description:"İndirim ve kampanyalar"},{key:"push_all",label:"Push bildirimleri",description:"Anlık bildirimler"}].map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:s.label}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",defaultChecked:!0,className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-muted peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary/20 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary"})]})]},s.key))})]})]},m)})]})]})}export{te as default};
