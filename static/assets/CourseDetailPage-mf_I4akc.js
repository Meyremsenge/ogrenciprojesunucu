import{u as L,a as _,b as C,j as e}from"./query-CQKFQ3Lv.js";import{f as P,b as S,L as o}from"./vendor-izpyVFLd.js";import{a as T,c as x}from"./index-LWY5EKPO.js";import{e as B,u as Q,b as M,c as A}from"./courseService-CXLj55ve.js";import{p as g,B as p,y as O,R,m as d,W as z,c as $,N as K,ak as j,C as I,s as q,al as G,am as H,an as U,a6 as V,Y as W}from"./ui-xp2o30bu.js";import"./charts-Db6Lds24.js";import"./api-DJoBUiCV.js";const Y=r=>r?{beginner:"Başlangıç",intermediate:"Orta",advanced:"İleri"}[r]||r:"";function re(){var b,v,w,k;const{id:r}=P();S();const i=L(),{user:u}=T(),a=parseInt(r||"0"),{data:s,isLoading:D,isError:E,error:h,refetch:y}=_({queryKey:["course",a],queryFn:()=>M(a),enabled:a>0}),{data:f=[]}=_({queryKey:["courseTopics",a],queryFn:()=>A(a),enabled:a>0}),n=C({mutationFn:()=>B(a),onSuccess:()=>{i.invalidateQueries({queryKey:["course",a]}),i.invalidateQueries({queryKey:["myCourses"]})}}),l=C({mutationFn:()=>Q(a),onSuccess:()=>{i.invalidateQueries({queryKey:["course",a]}),i.invalidateQueries({queryKey:["myCourses"]})}}),N=(s==null?void 0:s.is_enrolled)||!1,F=(u==null?void 0:u.id)===(s==null?void 0:s.teacher_id);if(D)return e.jsx("div",{className:"flex items-center justify-center py-24",children:e.jsx(g,{className:"h-8 w-8 animate-spin text-primary"})});if(E||!s)return e.jsxs("div",{className:"text-center py-24",children:[e.jsx(p,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Kurs bulunamadı"}),e.jsx("p",{className:"text-red-500 mt-2",children:(h==null?void 0:h.message)||"Bir hata oluştu"}),e.jsxs("div",{className:"flex items-center justify-center gap-4 mt-4",children:[e.jsx("button",{onClick:()=>y(),className:"px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90",children:"Tekrar Dene"}),e.jsx(o,{to:"/courses",className:"px-4 py-2 border rounded-lg hover:bg-muted",children:"Kurslara Dön"})]})]});const m=s.total_duration?Math.round(s.total_duration/60):0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(o,{to:"/courses",className:"inline-flex items-center gap-2 text-muted-foreground hover:text-foreground",children:[e.jsx(O,{className:"h-4 w-4"}),"Kurslara Dön"]}),e.jsx("button",{onClick:()=>y(),className:"p-2 rounded-lg border hover:bg-muted transition-colors",children:e.jsx(R,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"card p-6",children:[e.jsx("div",{className:"h-64 bg-gradient-to-br from-primary/20 to-primary/5 rounded-lg flex items-center justify-center mb-6 overflow-hidden",children:s.thumbnail_url?e.jsx("img",{src:s.thumbnail_url,alt:s.title,className:"w-full h-full object-cover"}):e.jsx(p,{className:"h-16 w-16 text-primary/40"})}),e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.category&&e.jsx("span",{className:"badge badge-primary",children:s.category}),s.level&&e.jsx("span",{className:"badge bg-muted text-muted-foreground",children:Y(s.level)}),!s.is_published&&e.jsx("span",{className:"badge bg-yellow-100 text-yellow-700",children:"Taslak"})]}),e.jsx("h1",{className:"text-2xl font-bold",children:s.title}),e.jsx("p",{className:"text-muted-foreground mt-3",children:s.description}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 mt-4 text-sm",children:[s.average_rating>0&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(z,{className:"h-4 w-4 text-yellow-500"}),e.jsx("strong",{children:s.average_rating.toFixed(1)})," (",s.rating_count||0," değerlendirme)"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx($,{className:"h-4 w-4 text-muted-foreground"}),((b=s.enrollment_count)==null?void 0:b.toLocaleString())||0," öğrenci"]}),m>0&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(K,{className:"h-4 w-4 text-muted-foreground"}),m," saat"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(j,{className:"h-4 w-4 text-muted-foreground"}),s.lesson_count||0," ders"]}),s.updated_at&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(I,{className:"h-4 w-4 text-muted-foreground"}),"Son güncelleme: ",new Date(s.updated_at).toLocaleDateString("tr-TR")]})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-6 pt-6 border-t",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx("span",{className:"text-lg font-semibold text-primary",children:((v=s.teacher_name)==null?void 0:v.charAt(0))||"E"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.teacher_name||"Eğitmen"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Eğitmen"})]})]})]}),s.learning_objectives&&s.learning_objectives.length>0&&e.jsxs(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"card p-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Bu kursta neler öğreneceksiniz?"}),e.jsx("div",{className:"grid md:grid-cols-2 gap-3",children:s.learning_objectives.map((t,c)=>e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(q,{className:"h-5 w-5 text-green-500 flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"text-sm",children:t})]},c))})]}),f.length>0&&e.jsxs(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"card p-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Müfredat"}),e.jsx("div",{className:"space-y-4",children:f.map((t,c)=>e.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-muted/50 px-4 py-3 font-medium flex items-center justify-between",children:[e.jsxs("span",{children:[c+1,". ",t.title]}),t.lesson_count!==void 0&&e.jsxs("span",{className:"text-sm text-muted-foreground",children:[t.lesson_count," ders"]})]}),t.description&&e.jsx("div",{className:"px-4 py-3 text-sm text-muted-foreground",children:t.description})]},t.id))})]}),s.requirements&&s.requirements.length>0&&e.jsxs(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"card p-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Gereksinimler"}),e.jsx("ul",{className:"space-y-2",children:s.requirements.map((t,c)=>e.jsxs("li",{className:"flex items-center gap-2 text-sm",children:[e.jsx("div",{className:"h-1.5 w-1.5 rounded-full bg-primary"}),t]},c))})]})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"card p-6 sticky top-20",children:[N&&e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-400 px-4 py-3 rounded-lg mb-4 flex items-center gap-2",children:[e.jsx(q,{className:"h-5 w-5"}),e.jsx("span",{children:"Bu kursa kayıtlısınız"})]}),e.jsx("div",{className:"space-y-3",children:F?e.jsx(e.Fragment,{children:e.jsxs(o,{to:`/courses/${a}/edit`,className:x("w-full py-3 rounded-lg font-medium flex items-center justify-center gap-2","bg-primary text-primary-foreground hover:bg-primary/90 transition-colors"),children:[e.jsx(G,{className:"h-4 w-4"}),"Kursu Düzenle"]})}):N?e.jsxs(e.Fragment,{children:[e.jsxs(o,{to:`/courses/${a}/learn`,className:x("w-full py-3 rounded-lg font-medium flex items-center justify-center gap-2","bg-primary text-primary-foreground hover:bg-primary/90 transition-colors"),children:[e.jsx(j,{className:"h-4 w-4"}),"Derse Devam Et"]}),e.jsxs("button",{onClick:()=>l.mutate(),disabled:l.isPending,className:x("w-full py-3 rounded-lg font-medium flex items-center justify-center gap-2","border text-red-600 hover:bg-red-50 transition-colors"),children:[l.isPending?e.jsx(g,{className:"h-4 w-4 animate-spin"}):e.jsx(H,{className:"h-4 w-4"}),"Kaydı İptal Et"]})]}):e.jsx("button",{onClick:()=>n.mutate(),disabled:n.isPending,className:x("w-full py-3 rounded-lg font-medium flex items-center justify-center gap-2","bg-primary text-primary-foreground hover:bg-primary/90 transition-colors"),children:n.isPending?e.jsx(g,{className:"h-4 w-4 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(p,{className:"h-4 w-4"}),"Kursa Kayıt Ol"]})})}),e.jsxs("div",{className:"mt-6 pt-6 border-t space-y-3",children:[e.jsx("h3",{className:"font-medium",children:"Bu kurs şunları içerir:"}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(K,{className:"h-4 w-4 text-muted-foreground"}),m>0?`${m} saat video içerik`:"Video içerik"]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(j,{className:"h-4 w-4 text-muted-foreground"}),s.lesson_count||0," ders"]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(U,{className:"h-4 w-4 text-muted-foreground"}),"Tamamlama sertifikası"]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(V,{className:"h-4 w-4 text-muted-foreground"}),"İndirilebilir kaynaklar"]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(W,{className:"h-4 w-4 text-muted-foreground"}),"Proje ödevleri"]})]}),n.isError&&e.jsx("p",{className:"text-red-500 text-sm mt-4",children:((w=n.error)==null?void 0:w.message)||"Kayıt yapılamadı"}),l.isError&&e.jsx("p",{className:"text-red-500 text-sm mt-4",children:((k=l.error)==null?void 0:k.message)||"Kayıt iptal edilemedi"})]})})]})]})}export{re as default};
