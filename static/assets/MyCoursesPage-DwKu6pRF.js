import{a as w,j as e}from"./query-CZD0ZRD-.js";import{r as u,L as h}from"./vendor-izpyVFLd.js";import{c as n}from"./index-CJixA8aD.js";import{g as C}from"./courseService-DBMG8AyS.js";import{R as _,p as S,k as L,m as M,B as b,av as D,y as K,s as T,ar as B}from"./ui-CAO-iScS.js";import"./charts-Db6Lds24.js";import"./api-Tqb-OO70.js";function F(){const[x,N]=u.useState(""),[i,v]=u.useState("all"),{data:p,isLoading:t,isError:o,error:g,refetch:f}=w({queryKey:["myCourses"],queryFn:()=>C()}),l=(p==null?void 0:p.items)||[],y=u.useMemo(()=>l.filter(s=>{var a,d;if(!((d=(a=s.course)==null?void 0:a.title)==null?void 0:d.toLowerCase().includes(x.toLowerCase())))return!1;const r=s.progress_percentage||0;switch(i){case"in-progress":return r>0&&r<100;case"completed":return s.status==="completed"||r===100;case"not-started":return r===0;default:return!0}}),[l,x,i]),m=u.useMemo(()=>({total:l.length,inProgress:l.filter(s=>{const c=s.progress_percentage||0;return c>0&&c<100}).length,completed:l.filter(s=>s.status==="completed"||s.progress_percentage===100).length,notStarted:l.filter(s=>(s.progress_percentage||0)===0).length}),[l]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Kurslarım"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Kayıtlı olduğunuz kursları buradan takip edebilirsiniz"})]}),e.jsx("button",{onClick:()=>f(),disabled:t,className:"p-2 rounded-lg border hover:bg-muted transition-colors disabled:opacity-50",children:e.jsx(_,{className:n("h-5 w-5",t&&"animate-spin")})})]}),t&&e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(S,{className:"h-8 w-8 animate-spin text-primary"})}),o&&e.jsxs("div",{className:"text-center py-12",children:[e.jsxs("p",{className:"text-red-500 mb-4",children:["Hata: ",(g==null?void 0:g.message)||"Kurslar yüklenemedi"]}),e.jsx("button",{onClick:()=>f(),className:"px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90",children:"Tekrar Dene"})]}),!t&&!o&&e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[{label:"Toplam",value:m.total,color:"bg-primary/10 text-primary"},{label:"Devam Ediyor",value:m.inProgress,color:"bg-blue-100 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400"},{label:"Tamamlandı",value:m.completed,color:"bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400"},{label:"Başlanmadı",value:m.notStarted,color:"bg-gray-100 text-gray-600 dark:bg-gray-800 dark:text-gray-400"}].map(s=>e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:n("text-2xl font-bold",s.color.split(" ")[1]),children:s.value}),e.jsx("div",{className:"text-sm text-muted-foreground",children:s.label})]},s.label))}),!t&&!o&&e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(L,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"}),e.jsx("input",{type:"text",value:x,onChange:s=>N(s.target.value),placeholder:"Kurs ara...",className:"w-full pl-10 pr-4 py-2 rounded-lg border bg-background focus:outline-none focus:ring-2 focus:ring-primary/50"})]}),e.jsx("div",{className:"flex items-center border rounded-lg overflow-hidden",children:[{key:"all",label:"Tümü"},{key:"in-progress",label:"Devam Ediyor"},{key:"completed",label:"Tamamlandı"},{key:"not-started",label:"Başlanmadı"}].map(s=>e.jsx("button",{onClick:()=>v(s.key),className:n("px-4 py-2 text-sm transition-colors",i===s.key?"bg-primary text-primary-foreground":"hover:bg-muted"),children:s.label},s.key))})]}),!t&&!o&&e.jsx("div",{className:"space-y-4",children:y.map((s,c)=>{const r=s.course;if(!r)return null;const a=Math.round(s.progress_percentage||0),d=r.lesson_count||0,k=Math.round(d*a/100),j=r.total_duration||0;return e.jsx(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:c*.05},children:e.jsx("div",{className:"card p-4 hover:shadow-lg transition-shadow",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"w-40 h-24 flex-shrink-0 bg-gradient-to-br from-primary/20 to-primary/5 rounded-lg flex items-center justify-center overflow-hidden",children:r.thumbnail_url?e.jsx("img",{src:r.thumbnail_url,alt:r.title,className:"w-full h-full object-cover"}):e.jsx(b,{className:"h-8 w-8 text-primary/40"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx(h,{to:`/courses/${r.id}`,className:"font-semibold hover:text-primary transition-colors",children:r.title}),e.jsx("p",{className:"text-sm text-muted-foreground mt-0.5",children:r.teacher_name})]}),e.jsx("button",{className:"p-1 hover:bg-muted rounded",children:e.jsx(D,{className:"h-5 w-5 text-muted-foreground"})})]}),e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm mb-1",children:[e.jsxs("span",{className:"text-muted-foreground",children:[k," / ",d," ders tamamlandı"]}),e.jsxs("span",{className:n("font-medium",a===100?"text-green-500":"text-primary"),children:["%",a]})]}),e.jsx("div",{className:"progress",children:e.jsx("div",{className:n("progress-bar",a===100&&"bg-green-500"),style:{width:`${a}%`}})})]}),e.jsxs("div",{className:"flex items-center justify-between mt-3",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[j>0&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(K,{className:"h-4 w-4"}),Math.round(j/60)," saat"]}),s.last_accessed_at&&e.jsxs("span",{children:["Son erişim: ",new Date(s.last_accessed_at).toLocaleDateString("tr-TR")]})]}),a===100?e.jsxs("span",{className:"flex items-center gap-1 text-sm text-green-500",children:[e.jsx(T,{className:"h-4 w-4"}),"Tamamlandı"]}):e.jsxs(h,{to:`/courses/${r.id}/learn`,className:n("flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium","bg-primary text-primary-foreground hover:bg-primary/90 transition-colors"),children:[e.jsx(B,{className:"h-4 w-4"}),a===0?"Başla":"Devam Et"]})]})]})]})})},s.id)})}),!t&&!o&&y.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(b,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Kurs bulunamadı"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:i==="all"?"Henüz bir kursa kayıt olmadınız.":"Bu kategoride kurs bulunmuyor."}),i==="all"&&e.jsx(h,{to:"/courses",className:n("inline-flex items-center gap-2 mt-4 px-4 py-2 rounded-lg font-medium","bg-primary text-primary-foreground hover:bg-primary/90 transition-colors"),children:"Kurslara Göz At"})]})]})}export{F as default};
