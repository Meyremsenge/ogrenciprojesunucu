import{u as K,a as L,b as v,j as e}from"./query-CZD0ZRD-.js";import{r as u}from"./vendor-izpyVFLd.js";import{a as q,c as d}from"./index-D2ID2HJ6.js";import{u as B,c as F,g as R}from"./userService-15brR9Ux.js";import{m as y,bf as Y,C as H,U as P,f as C,l as Q,q as w,ab as _,N as G,P as O,a_ as I,n as k,aZ as V,_ as W}from"./ui-CGOJK0BY.js";import"./charts-Db6Lds24.js";import"./api-CsRKlOc7.js";const Z=[{key:"profile",label:"Profil Bilgileri",icon:P},{key:"security",label:"Güvenlik",icon:C}];function te(){var h,b,j,N;const{user:i,logout:S}=q(),D=K(),[x,z]=u.useState("profile"),[t,f]=u.useState(!1),[A,g]=u.useState(!1),[r,m]=u.useState({first_name:(i==null?void 0:i.first_name)||"",last_name:(i==null?void 0:i.last_name)||"",phone:"",address:""}),[l,p]=u.useState({current_password:"",new_password:"",confirm_password:""}),{data:n,isLoading:J}=L({queryKey:["myProfile"],queryFn:R}),s=n||i;n&&r.first_name===""&&n.first_name&&m({first_name:n.first_name||"",last_name:n.last_name||"",phone:n.phone||"",address:n.address||""});const o=v({mutationFn:a=>B(a),onSuccess:()=>{D.invalidateQueries({queryKey:["myProfile"]}),f(!1)}}),c=v({mutationFn:a=>F(a),onSuccess:()=>{g(!1),p({current_password:"",new_password:"",confirm_password:""})}}),M=()=>{o.mutate(r)},X=()=>{if(l.new_password!==l.confirm_password){alert("Yeni şifreler eşleşmiyor");return}c.mutate({old_password:l.current_password,new_password:l.new_password})},E=()=>{S(),window.location.href="/login"};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Hesap Ayarları"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Profil bilgilerinizi ve hesap ayarlarınızı yönetin"})]}),e.jsx(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"card p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-24 h-24 rounded-full bg-primary/10 flex items-center justify-center overflow-hidden",children:s!=null&&s.avatar_url?e.jsx("img",{src:s.avatar_url,alt:"Avatar",className:"w-full h-full object-cover"}):e.jsxs("span",{className:"text-3xl font-bold text-primary",children:[(h=s==null?void 0:s.first_name)==null?void 0:h[0],(b=s==null?void 0:s.last_name)==null?void 0:b[0]]})}),e.jsx("button",{className:"absolute bottom-0 right-0 p-2 rounded-full bg-primary text-primary-foreground hover:bg-primary/90",children:e.jsx(Y,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex-1 text-center md:text-left",children:[e.jsxs("h2",{className:"text-xl font-bold",children:[s==null?void 0:s.first_name," ",s==null?void 0:s.last_name]}),e.jsx("p",{className:"text-muted-foreground",children:s==null?void 0:s.email}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center md:justify-start gap-4 mt-3 text-sm text-muted-foreground",children:[e.jsx("span",{className:"badge badge-primary capitalize",children:s==null?void 0:s.role}),(s==null?void 0:s.created_at)&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(H,{className:"h-4 w-4"}),"Katılım: ",new Date(s.created_at).toLocaleDateString("tr-TR",{year:"numeric",month:"long"})]})]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx("button",{onClick:()=>f(!t),className:d("px-4 py-2 rounded-lg font-medium transition-colors",t?"bg-muted hover:bg-muted/80":"bg-primary text-primary-foreground hover:bg-primary/90"),children:t?"İptal":"Düzenle"})})]})}),e.jsxs("div",{className:"grid lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"card p-2 space-y-1",children:[Z.map(a=>e.jsxs("button",{onClick:()=>z(a.key),className:d("w-full flex items-center gap-3 px-4 py-3 rounded-lg text-left transition-colors",x===a.key?"bg-primary text-primary-foreground":"hover:bg-muted"),children:[e.jsx(a.icon,{className:"h-5 w-5"}),a.label]},a.key)),e.jsx("hr",{className:"my-2"}),e.jsxs("button",{onClick:E,className:"w-full flex items-center gap-3 px-4 py-3 rounded-lg text-left text-destructive hover:bg-destructive/10",children:[e.jsx(Q,{className:"h-5 w-5"}),"Çıkış Yap"]})]})}),e.jsx("div",{className:"lg:col-span-3",children:e.jsxs(y.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"card p-6",children:[x==="profile"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Kişisel Bilgiler"}),o.isSuccess&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-green-50 text-green-700 rounded-lg",children:[e.jsx(w,{className:"h-5 w-5"}),"Profil başarıyla güncellendi"]}),o.isError&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-red-50 text-red-700 rounded-lg",children:[e.jsx(_,{className:"h-5 w-5"}),((j=o.error)==null?void 0:j.message)||"Bir hata oluştu"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"İsim"}),e.jsxs("div",{className:"relative",children:[e.jsx(P,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"}),e.jsx("input",{type:"text",value:r.first_name,onChange:a=>m({...r,first_name:a.target.value}),disabled:!t,className:d("w-full pl-10 pr-4 py-2 rounded-lg border bg-background","focus:outline-none focus:ring-2 focus:ring-primary/50","disabled:opacity-60 disabled:cursor-not-allowed")})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Soyisim"}),e.jsx("input",{type:"text",value:r.last_name,onChange:a=>m({...r,last_name:a.target.value}),disabled:!t,className:d("w-full px-4 py-2 rounded-lg border bg-background","focus:outline-none focus:ring-2 focus:ring-primary/50","disabled:opacity-60 disabled:cursor-not-allowed")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"E-posta"}),e.jsxs("div",{className:"relative",children:[e.jsx(G,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"}),e.jsx("input",{type:"email",defaultValue:s==null?void 0:s.email,disabled:!0,className:"w-full pl-10 pr-4 py-2 rounded-lg border bg-muted opacity-60 cursor-not-allowed"})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"E-posta değişikliği için destek ile iletişime geçin"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Telefon"}),e.jsxs("div",{className:"relative",children:[e.jsx(O,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"}),e.jsx("input",{type:"tel",value:r.phone,onChange:a=>m({...r,phone:a.target.value}),placeholder:"+90 5XX XXX XX XX",disabled:!t,className:d("w-full pl-10 pr-4 py-2 rounded-lg border bg-background","focus:outline-none focus:ring-2 focus:ring-primary/50","disabled:opacity-60 disabled:cursor-not-allowed")})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Adres"}),e.jsxs("div",{className:"relative",children:[e.jsx(I,{className:"absolute left-3 top-3 h-5 w-5 text-muted-foreground"}),e.jsx("textarea",{value:r.address,onChange:a=>m({...r,address:a.target.value}),placeholder:"Adresinizi girin",disabled:!t,rows:3,className:d("w-full pl-10 pr-4 py-2 rounded-lg border bg-background resize-none","focus:outline-none focus:ring-2 focus:ring-primary/50","disabled:opacity-60 disabled:cursor-not-allowed")})]})]})]}),t&&e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:M,disabled:o.isPending,className:d("flex items-center gap-2 px-6 py-2 rounded-lg font-medium","bg-primary text-primary-foreground hover:bg-primary/90","disabled:opacity-50"),children:[o.isPending?e.jsx(k,{className:"h-4 w-4 animate-spin"}):e.jsx(V,{className:"h-4 w-4"}),"Değişiklikleri Kaydet"]})})]}),x==="security"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Güvenlik Ayarları"}),c.isSuccess&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-green-50 text-green-700 rounded-lg",children:[e.jsx(w,{className:"h-5 w-5"}),"Şifre başarıyla değiştirildi"]}),c.isError&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-red-50 text-red-700 rounded-lg",children:[e.jsx(_,{className:"h-5 w-5"}),((N=c.error)==null?void 0:N.message)||"Şifre değiştirilemedi"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-4 border rounded-lg",children:A?e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium",children:"Şifre Değiştir"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"Mevcut Şifre"}),e.jsx("input",{type:"password",value:l.current_password,onChange:a=>p({...l,current_password:a.target.value}),className:"w-full px-4 py-2 rounded-lg border bg-background focus:outline-none focus:ring-2 focus:ring-primary/50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"Yeni Şifre"}),e.jsx("input",{type:"password",value:l.new_password,onChange:a=>p({...l,new_password:a.target.value}),className:"w-full px-4 py-2 rounded-lg border bg-background focus:outline-none focus:ring-2 focus:ring-primary/50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",children:"Yeni Şifre (Tekrar)"}),e.jsx("input",{type:"password",value:l.confirm_password,onChange:a=>p({...l,confirm_password:a.target.value}),className:"w-full px-4 py-2 rounded-lg border bg-background focus:outline-none focus:ring-2 focus:ring-primary/50"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:X,disabled:c.isPending,className:"px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 disabled:opacity-50",children:c.isPending?e.jsx(k,{className:"h-4 w-4 animate-spin"}):"Şifreyi Değiştir"}),e.jsx("button",{onClick:()=>g(!1),className:"px-4 py-2 border rounded-lg hover:bg-muted",children:"İptal"})]})]}):e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(W,{className:"h-5 w-5 text-muted-foreground mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Şifre Değiştir"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Hesap güvenliği için şifrenizi düzenli olarak değiştirin"})]})]}),e.jsx("button",{onClick:()=>g(!0),className:"px-4 py-2 border rounded-lg hover:bg-muted",children:"Değiştir"})]})}),e.jsx("div",{className:"p-4 border rounded-lg",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(C,{className:"h-5 w-5 text-muted-foreground mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"İki Faktörlü Doğrulama"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Hesabınızı daha güvenli hale getirin"})]})]}),e.jsx("button",{className:"px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90",children:"Aktifleştir"})]})}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Aktif Oturumlar"}),e.jsx("div",{className:"space-y-3",children:[{device:"Windows - Chrome",location:"İstanbul, TR",current:!0},{device:"iPhone - Safari",location:"İstanbul, TR",current:!1}].map((a,T)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium",children:[a.device,a.current&&e.jsx("span",{className:"ml-2 badge badge-success",children:"Bu cihaz"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a.location})]}),!a.current&&e.jsx("button",{className:"text-sm text-destructive hover:underline",children:"Sonlandır"})]},T))})]})]})]})]},x)})]})]})}export{te as default};
