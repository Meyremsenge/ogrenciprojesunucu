import{a as I,b as P,j as e}from"./query-CZD0ZRD-.js";import{b as D,r as n}from"./vendor-izpyVFLd.js";import{B as b,c as d,I as h}from"./index-D2ID2HJ6.js";import{aO as N,V as K,aL as v,aN as O,S as B,m as F,a0 as y,C as w,c as T,w as A,O as R,aS as V,n as E,r as L}from"./ui-CGOJK0BY.js";import"./charts-Db6Lds24.js";function _(){const o=D(),[a,i]=n.useState({title:"",description:"",courseId:null,maxParticipants:100,isRecorded:!0,scheduledAt:null}),[c,p]=n.useState(!1),[l,g]=n.useState(!1),[r,j]=n.useState("now"),[k,f]=n.useState(!1),[t,m]=n.useState(null),{data:x}=I({queryKey:["teacherCourses"],queryFn:async()=>[{id:1,title:"React ile Modern Web"},{id:2,title:"Python Veri Bilimi"},{id:3,title:"JavaScript Fundamentals"}]}),C=async()=>{if(c)t==null||t.getTracks().forEach(s=>s.stop()),m(null),p(!1);else try{const s=await navigator.mediaDevices.getUserMedia({video:!0,audio:l});m(s),p(!0)}catch(s){console.error("Kamera erişimi hatası:",s)}},S=async()=>{if(t){const s=t.getAudioTracks()[0];s&&(s.enabled=!l,g(!l))}else if(!l)try{const s=await navigator.mediaDevices.getUserMedia({audio:!0});m(s),g(!0)}catch(s){console.error("Mikrofon erişimi hatası:",s)}},u=P({mutationFn:async()=>{const s=await fetch("/api/v1/live-classes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...a,scheduled_at:r==="schedule"?a.scheduledAt:null,start_immediately:r==="now"})});if(!s.ok)throw new Error("Canlı ders oluşturulamadı");return s.json()},onSuccess:s=>{o(r==="now"?`/live/${s.id}/host`:"/live")}}),M=()=>{navigator.clipboard.writeText("https://example.com/live/abc123"),f(!0),setTimeout(()=>f(!1),2e3)};return e.jsxs("div",{className:"max-w-6xl mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Canlı Ders Başlat"}),e.jsx("p",{className:"text-muted-foreground",children:"Öğrencilerinizle canlı bir ders oturumu başlatın"})]}),e.jsx(b,{variant:"outline",onClick:()=>o(-1),children:"İptal"})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"aspect-video bg-slate-900 rounded-xl overflow-hidden relative",children:[c&&t?e.jsx("video",{autoPlay:!0,muted:!0,playsInline:!0,ref:s=>{s&&t&&(s.srcObject=t)},className:"w-full h-full object-cover"}):e.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center text-slate-500",children:[e.jsx(N,{className:"h-16 w-16 mb-4"}),e.jsx("p",{children:"Kamera kapalı"})]}),e.jsxs("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 flex gap-2",children:[e.jsx("button",{onClick:C,className:d("p-3 rounded-full transition-colors",c?"bg-white text-slate-900":"bg-red-500 text-white"),children:c?e.jsx(K,{className:"h-5 w-5"}):e.jsx(N,{className:"h-5 w-5"})}),e.jsx("button",{onClick:S,className:d("p-3 rounded-full transition-colors",l?"bg-white text-slate-900":"bg-red-500 text-white"),children:l?e.jsx(v,{className:"h-5 w-5"}):e.jsx(O,{className:"h-5 w-5"})})]})]}),e.jsxs("div",{className:"bg-card border rounded-xl p-4 space-y-3",children:[e.jsxs("h3",{className:"font-medium flex items-center gap-2",children:[e.jsx(B,{className:"h-4 w-4"}),"Cihaz Ayarları"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs text-muted-foreground",children:"Kamera"}),e.jsx("select",{className:"w-full bg-muted rounded-lg px-3 py-2 text-sm",children:e.jsx("option",{children:"Varsayılan Kamera"})})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs text-muted-foreground",children:"Mikrofon"}),e.jsx("select",{className:"w-full bg-muted rounded-lg px-3 py-2 text-sm",children:e.jsx("option",{children:"Varsayılan Mikrofon"})})]})]}),l&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("div",{className:"flex-1 h-2 bg-muted rounded-full overflow-hidden",children:e.jsx(F.div,{className:"h-full bg-green-500",animate:{width:["20%","60%","40%","80%","30%"]},transition:{duration:1,repeat:1/0,repeatType:"reverse"}})})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2 p-1 bg-muted rounded-lg",children:[e.jsxs("button",{onClick:()=>j("now"),className:d("flex-1 flex items-center justify-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-all",r==="now"?"bg-background shadow text-primary":"text-muted-foreground hover:text-foreground"),children:[e.jsx(y,{className:"h-4 w-4"}),"Şimdi Başlat"]}),e.jsxs("button",{onClick:()=>j("schedule"),className:d("flex-1 flex items-center justify-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-all",r==="schedule"?"bg-background shadow text-primary":"text-muted-foreground hover:text-foreground"),children:[e.jsx(w,{className:"h-4 w-4"}),"Planla"]})]}),e.jsxs("div",{className:"bg-card border rounded-xl p-6 space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Ders Başlığı *"}),e.jsx(h,{placeholder:"Ör: React Hooks Canlı Ders",value:a.title,onChange:s=>i({...a,title:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Açıklama"}),e.jsx("textarea",{className:"w-full min-h-[80px] rounded-lg border bg-background px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Bu derste neler işlenecek...",value:a.description,onChange:s=>i({...a,description:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"İlgili Kurs"}),e.jsxs("select",{className:"w-full bg-background border rounded-lg px-3 py-2 text-sm",value:a.courseId||"",onChange:s=>i({...a,courseId:s.target.value?parseInt(s.target.value):null}),children:[e.jsx("option",{value:"",children:"Kurs seçin (opsiyonel)"}),x==null?void 0:x.map(s=>e.jsx("option",{value:s.id,children:s.title},s.id))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Maks. Katılımcı"}),e.jsx(h,{type:"number",value:a.maxParticipants,onChange:s=>i({...a,maxParticipants:parseInt(s.target.value)||100}),leftIcon:e.jsx(T,{className:"h-4 w-4"})})]})]}),r==="schedule"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Tarih ve Saat"}),e.jsx(h,{type:"datetime-local",value:a.scheduledAt||"",onChange:s=>i({...a,scheduledAt:s.target.value}),leftIcon:e.jsx(A,{className:"h-4 w-4"})})]}),e.jsxs("label",{className:"flex items-center gap-3 p-3 bg-muted/50 rounded-lg cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a.isRecorded,onChange:s=>i({...a,isRecorded:s.target.checked}),className:"h-4 w-4 rounded border-muted"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:"Dersi kaydet"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Kayıt otomatik olarak kurs içeriğine eklenecek"})]})]}),e.jsxs("div",{className:"p-3 bg-primary/5 border border-primary/20 rounded-lg space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Ders Bağlantısı"}),e.jsx("button",{onClick:M,className:"text-xs text-primary hover:underline flex items-center gap-1",children:k?e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"h-3 w-3"}),"Kopyalandı!"]}):e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"h-3 w-3"}),"Kopyala"]})})]}),e.jsx("div",{className:"flex items-center gap-2 text-xs text-muted-foreground bg-background rounded px-3 py-2",children:e.jsx("span",{className:"truncate",children:"https://example.com/live/abc123"})})]})]}),e.jsx(b,{className:"w-full py-6 text-lg",onClick:()=>u.mutate(),disabled:!a.title||u.isPending,children:u.isPending?e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"h-5 w-5 mr-2 animate-spin"}),"Hazırlanıyor..."]}):r==="now"?e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"h-5 w-5 mr-2"}),"Canlı Dersi Başlat"]}):e.jsxs(e.Fragment,{children:[e.jsx(w,{className:"h-5 w-5 mr-2"}),"Dersi Planla"]})}),e.jsxs("div",{className:"flex items-start gap-2 p-3 bg-amber-500/10 border border-amber-500/20 rounded-lg text-amber-700 dark:text-amber-400 text-sm",children:[e.jsx(L,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),e.jsx("p",{children:"Canlı ders başladığında tüm kayıtlı öğrencilere bildirim gönderilecektir."})]})]})]})]})}export{_ as default};
