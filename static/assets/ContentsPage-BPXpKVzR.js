import{a as C,j as e}from"./query-CZD0ZRD-.js";import{b as K,r as u,L as Q}from"./vendor-izpyVFLd.js";import{a as A,c as d}from"./index-CJixA8aD.js";import{a as L}from"./api-Tqb-OO70.js";import{a6 as Y,R as G,k as O,ap as H,aq as I,ao as J,V as j,a5 as y,p as U,m as N,y as W,q as v,a1 as X}from"./ui-CAO-iScS.js";import"./charts-Db6Lds24.js";const Z=async s=>(await L.get("/contents/videos",{params:s})).data.data,ee=async s=>(await L.get("/contents/documents",{params:s})).data.data,V=s=>s?{draft:{label:"Taslak",color:"bg-gray-100 text-gray-700"},pending_review:{label:"İnceleme Bekliyor",color:"bg-yellow-100 text-yellow-700"},approved:{label:"Onaylandı",color:"bg-blue-100 text-blue-700"},published:{label:"Yayında",color:"bg-green-100 text-green-700"},rejected:{label:"Reddedildi",color:"bg-red-100 text-red-700"},archived:{label:"Arşivlendi",color:"bg-gray-100 text-gray-500"}}[s]||{label:s,color:"bg-gray-100 text-gray-700"}:{label:"Bilinmiyor",color:"bg-gray-100 text-gray-700"};function oe(){const s=K(),{user:r}=A(),[l,x]=u.useState("grid"),[i,m]=u.useState(""),[o,p]=u.useState(""),[a,M]=u.useState("all"),[h,w]=u.useState(1),[g,k]=u.useState(1);u.useEffect(()=>{const t=setTimeout(()=>{p(i),w(1),k(1)},300);return()=>clearTimeout(t)},[i]);const{data:n,isLoading:T,refetch:z}=C({queryKey:["videos",{search:o,page:h}],queryFn:()=>Z({search:o||void 0,page:h,per_page:12,status:"published"}),enabled:a==="all"||a==="video"}),{data:c,isLoading:P,refetch:$}=C({queryKey:["documents",{search:o,page:g}],queryFn:()=>ee({search:o||void 0,page:g,per_page:12,status:"published"}),enabled:a==="all"||a==="document"}),_=(n==null?void 0:n.items)||[],S=(c==null?void 0:c.items)||[],f=T||P,q=(r==null?void 0:r.role)==="teacher"||(r==null?void 0:r.role)==="admin",F=()=>{z(),$()},B=t=>{s(`/contents/${t.id}/watch`)},R=t=>{s(`/contents/document/${t.id}`)},E=t=>{if(!t)return"";const b=Math.floor(t/60),D=t%60;return`${b}:${D.toString().padStart(2,"0")}`};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"İçerikler"}),e.jsx("p",{className:"text-muted-foreground",children:"Tüm eğitim materyallerine göz atın"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[q&&e.jsxs(Q,{to:"/contents/create",className:"flex items-center gap-2 px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90",children:[e.jsx(Y,{className:"h-4 w-4"}),"Yeni İçerik"]}),e.jsx("button",{onClick:F,disabled:f,className:"p-2 rounded-lg border hover:bg-muted transition-colors disabled:opacity-50",children:e.jsx(G,{className:d("h-5 w-5",f&&"animate-spin")})})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(O,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx("input",{type:"text",placeholder:"İçerik ara...",value:i,onChange:t=>m(t.target.value),className:"w-full pl-10 pr-4 py-2 rounded-lg border bg-background focus:outline-none focus:ring-2 focus:ring-primary/50"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>x("grid"),className:d("p-2 rounded-lg border transition-colors",l==="grid"?"bg-primary text-primary-foreground":"hover:bg-muted"),children:e.jsx(H,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>x("list"),className:d("p-2 rounded-lg border transition-colors",l==="list"?"bg-primary text-primary-foreground":"hover:bg-muted"),children:e.jsx(I,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"flex items-center border rounded-lg overflow-hidden w-fit",children:[{key:"all",label:"Tümü",icon:J},{key:"video",label:"Videolar",icon:j},{key:"document",label:"Dökümanlar",icon:y}].map(t=>e.jsxs("button",{onClick:()=>M(t.key),className:d("flex items-center gap-2 px-4 py-2 text-sm transition-colors",a===t.key?"bg-primary text-primary-foreground":"hover:bg-muted"),children:[e.jsx(t.icon,{className:"h-4 w-4"}),t.label]},t.key))}),f&&e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(U,{className:"h-8 w-8 animate-spin text-primary"})}),!f&&(a==="all"||a==="video")&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(j,{className:"h-5 w-5 text-primary"}),"Videolar",e.jsxs("span",{className:"text-sm font-normal text-muted-foreground",children:["(",(n==null?void 0:n.total)||0,")"]})]}),_.length===0?e.jsxs("div",{className:"text-center py-8 border rounded-lg",children:[e.jsx(j,{className:"h-10 w-10 text-muted-foreground mx-auto mb-2"}),e.jsx("p",{className:"text-muted-foreground",children:"Video bulunamadı"})]}):e.jsx("div",{className:d(l==="grid"?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4":"space-y-3"),children:_.map((t,b)=>e.jsx(se,{video:t,viewMode:l,index:b,onClick:()=>B(t),formatDuration:E},t.id))}),n&&n.pages>1&&e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("button",{onClick:()=>w(t=>Math.max(1,t-1)),disabled:h===1,className:"px-3 py-1 text-sm rounded border hover:bg-muted disabled:opacity-50",children:"Önceki"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[h," / ",n.pages]}),e.jsx("button",{onClick:()=>w(t=>Math.min(n.pages,t+1)),disabled:h===n.pages,className:"px-3 py-1 text-sm rounded border hover:bg-muted disabled:opacity-50",children:"Sonraki"})]})]}),!f&&(a==="all"||a==="document")&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(y,{className:"h-5 w-5 text-blue-500"}),"Dökümanlar",e.jsxs("span",{className:"text-sm font-normal text-muted-foreground",children:["(",(c==null?void 0:c.total)||0,")"]})]}),S.length===0?e.jsxs("div",{className:"text-center py-8 border rounded-lg",children:[e.jsx(y,{className:"h-10 w-10 text-muted-foreground mx-auto mb-2"}),e.jsx("p",{className:"text-muted-foreground",children:"Döküman bulunamadı"})]}):e.jsx("div",{className:d(l==="grid"?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4":"space-y-3"),children:S.map((t,b)=>e.jsx(te,{document:t,viewMode:l,index:b,onClick:()=>R(t)},t.id))}),c&&c.pages>1&&e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("button",{onClick:()=>k(t=>Math.max(1,t-1)),disabled:g===1,className:"px-3 py-1 text-sm rounded border hover:bg-muted disabled:opacity-50",children:"Önceki"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[g," / ",c.pages]}),e.jsx("button",{onClick:()=>k(t=>Math.min(c.pages,t+1)),disabled:g===c.pages,className:"px-3 py-1 text-sm rounded border hover:bg-muted disabled:opacity-50",children:"Sonraki"})]})]})]})}function se({video:s,viewMode:r,index:l,onClick:x,formatDuration:i}){var o,p;const m=V(s.status);return r==="list"?e.jsx(N.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:l*.05},onClick:x,className:"card p-4 cursor-pointer hover:shadow-md transition-all hover:border-primary/50",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"h-16 w-24 rounded-lg bg-gradient-to-br from-primary/20 to-primary/5 flex items-center justify-center flex-shrink-0 overflow-hidden",children:s.thumbnail_url?e.jsx("img",{src:s.thumbnail_url,alt:s.title,className:"w-full h-full object-cover"}):e.jsx(j,{className:"h-6 w-6 text-primary/40"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-semibold truncate",children:s.title}),e.jsx("span",{className:d("text-xs px-2 py-0.5 rounded",m.color),children:m.label})]}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:s.description}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-muted-foreground",children:[s.duration&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(W,{className:"h-3 w-3"}),i(s.duration)]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(v,{className:"h-3 w-3"}),((o=s.view_count)==null?void 0:o.toLocaleString())||0," izlenme"]}),e.jsx("span",{children:s.teacher_name})]})]})]})}):e.jsxs(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:l*.05},onClick:x,className:"card overflow-hidden cursor-pointer hover:shadow-lg transition-all hover:border-primary/50 group",children:[e.jsxs("div",{className:"aspect-video bg-gradient-to-br from-primary/20 to-primary/5 relative flex items-center justify-center",children:[s.thumbnail_url?e.jsx("img",{src:s.thumbnail_url,alt:s.title,className:"w-full h-full object-cover"}):e.jsx(j,{className:"h-12 w-12 text-primary/40 group-hover:scale-110 transition-transform"}),e.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/20 flex items-center justify-center transition-colors",children:e.jsx(X,{className:"h-12 w-12 text-white opacity-0 group-hover:opacity-100 transition-opacity"})}),e.jsx("span",{className:d("absolute top-2 right-2 text-xs px-2 py-0.5 rounded",m.color),children:m.label}),s.duration&&e.jsx("span",{className:"absolute bottom-2 right-2 bg-black/70 text-white text-xs px-2 py-0.5 rounded",children:i(s.duration)})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-semibold line-clamp-1",children:s.title}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2 mt-1",children:s.description}),e.jsxs("div",{className:"flex items-center justify-between mt-3",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:s.teacher_name}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsx(v,{className:"h-3 w-3"}),((p=s.view_count)==null?void 0:p.toLocaleString())||0]})]})]})]})}function te({document:s,viewMode:r,index:l,onClick:x}){var o,p;const i=V(s.status),m=a=>a?a<1024?`${a} B`:a<1024*1024?`${(a/1024).toFixed(1)} KB`:`${(a/(1024*1024)).toFixed(1)} MB`:"";return r==="list"?e.jsx(N.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:l*.05},onClick:x,className:"card p-4 cursor-pointer hover:shadow-md transition-all hover:border-blue-500/50",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"h-16 w-16 rounded-lg bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center flex-shrink-0",children:e.jsx(y,{className:"h-8 w-8 text-blue-500"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-semibold truncate",children:s.title}),e.jsx("span",{className:d("text-xs px-2 py-0.5 rounded",i.color),children:i.label})]}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:s.description}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-muted-foreground",children:[s.file_type&&e.jsx("span",{className:"uppercase",children:s.file_type}),s.file_size&&e.jsx("span",{children:m(s.file_size)}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(v,{className:"h-3 w-3"}),((o=s.view_count)==null?void 0:o.toLocaleString())||0," görüntüleme"]}),e.jsx("span",{children:s.teacher_name})]})]})]})}):e.jsxs(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:l*.05},onClick:x,className:"card overflow-hidden cursor-pointer hover:shadow-lg transition-all hover:border-blue-500/50 group",children:[e.jsxs("div",{className:"aspect-[4/3] bg-blue-50 dark:bg-blue-900/20 relative flex items-center justify-center",children:[e.jsx(y,{className:"h-16 w-16 text-blue-400 group-hover:scale-110 transition-transform"}),e.jsx("span",{className:d("absolute top-2 right-2 text-xs px-2 py-0.5 rounded",i.color),children:i.label}),s.file_type&&e.jsx("span",{className:"absolute bottom-2 left-2 bg-blue-500 text-white text-xs px-2 py-0.5 rounded uppercase",children:s.file_type})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-semibold line-clamp-1",children:s.title}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2 mt-1",children:s.description}),e.jsxs("div",{className:"flex items-center justify-between mt-3",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:s.teacher_name}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[s.file_size&&e.jsx("span",{children:m(s.file_size)}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(v,{className:"h-3 w-3"}),((p=s.view_count)==null?void 0:p.toLocaleString())||0]})]})]})]})]})}export{oe as default};
