# ==============================================
# PRODUCTION ENVIRONMENT CONFIGURATION
# ==============================================
# ⚠️  DİKKAT: Bu dosya production ortamında .env olarak kullanılmaz!
# ⚠️  Production secrets, CI/CD veya secret manager üzerinden yönetilmeli.
# 
# Bu dosya sadece gerekli değişkenlerin referansı içindir.
# Gerçek değerler:
#   - Docker: docker-compose secrets veya environment
#   - Kubernetes: ConfigMap + Secrets
#   - AWS: Secrets Manager veya Parameter Store
#   - HashiCorp Vault: vault secrets
# ==============================================

# ------------------------------------------
# APPLICATION
# ------------------------------------------
FLASK_ENV=production
FLASK_DEBUG=false
FLASK_HOST=0.0.0.0
FLASK_PORT=5000

APP_NAME="Öğrenci Koçluk Sistemi"
APP_VERSION=1.0.0
APP_URL=https://api.ogrencikoçluk.com
FRONTEND_URL=https://app.ogrencikoçluk.com

# ------------------------------------------
# SECURITY (ZORUNLU - Secret Manager'dan al)
# ------------------------------------------
SECRET_KEY=${SECRET_KEY}
JWT_SECRET_KEY=${JWT_SECRET_KEY}
JWT_ACCESS_TOKEN_EXPIRES=900
JWT_REFRESH_TOKEN_EXPIRES=604800
JWT_ALGORITHM=HS256

# CSRF
WTF_CSRF_ENABLED=true
WTF_CSRF_TIME_LIMIT=3600

# Session
SESSION_COOKIE_SECURE=true
SESSION_COOKIE_HTTPONLY=true
SESSION_COOKIE_SAMESITE=Strict
PERMANENT_SESSION_LIFETIME=86400

# Password Hashing (Yüksek - güvenlik öncelikli)
BCRYPT_LOG_ROUNDS=13

# Security Headers
SECURITY_HEADERS_ENABLED=true
CONTENT_SECURITY_POLICY=default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self'; connect-src 'self'; frame-ancestors 'none'; form-action 'self'; base-uri 'self'; object-src 'none'

# ------------------------------------------
# CORS (Production - Strict)
# ------------------------------------------
ALLOWED_ORIGINS=https://app.ogrencikoçluk.com

# ------------------------------------------
# DATABASE - PostgreSQL (Production Cluster)
# ------------------------------------------
# Primary write database
DATABASE_URL=${DATABASE_URL}
DB_HOST=db-primary.internal
DB_PORT=5432
DB_NAME=student_coaching
DB_USER=app_user
DB_PASSWORD=${DB_PASSWORD}
DB_SCHEMA=public

# Read replicas (virgülle ayrılmış)
DB_READ_REPLICAS=postgresql://app_user:${DB_PASSWORD}@db-replica-1.internal:5432/student_coaching,postgresql://app_user:${DB_PASSWORD}@db-replica-2.internal:5432/student_coaching

# Pool (Production - Large)
DB_POOL_SIZE=10
DB_POOL_MAX_OVERFLOW=20
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=1800
DB_POOL_PRE_PING=true

# SSL
DB_SSL_ENABLED=true
DB_SSL_CA_CERT=/etc/ssl/certs/rds-ca-2019-root.pem

# SQLAlchemy
SQLALCHEMY_ECHO=false
SQLALCHEMY_TRACK_MODIFICATIONS=false
SQLALCHEMY_RECORD_QUERIES=false

# ------------------------------------------
# REDIS (Production Cluster)
# ------------------------------------------
REDIS_URL=${REDIS_URL}
REDIS_HOST=redis-cluster.internal
REDIS_PORT=6379
REDIS_PASSWORD=${REDIS_PASSWORD}
REDIS_DB=0
REDIS_SSL=true

# Cache
CACHE_TYPE=redis
CACHE_DEFAULT_TIMEOUT=300
CACHE_KEY_PREFIX=sks:

# Redis Pool
REDIS_MAX_CONNECTIONS=20
REDIS_SOCKET_TIMEOUT=5
REDIS_SOCKET_CONNECT_TIMEOUT=5
REDIS_HEALTH_CHECK_INTERVAL=30

# ------------------------------------------
# CELERY (Production Workers)
# ------------------------------------------
CELERY_BROKER_URL=${CELERY_BROKER_URL}
CELERY_RESULT_BACKEND=${CELERY_RESULT_BACKEND}
CELERY_TASK_ALWAYS_EAGER=false
CELERY_TASK_TIME_LIMIT=300
CELERY_TASK_SOFT_TIME_LIMIT=240
CELERY_WORKER_CONCURRENCY=4
CELERY_WORKER_MAX_TASKS_PER_CHILD=1000

# ------------------------------------------
# EMAIL (Production SMTP/SES)
# ------------------------------------------
MAIL_SERVER=${MAIL_SERVER}
MAIL_PORT=587
MAIL_USE_TLS=true
MAIL_USE_SSL=false
MAIL_USERNAME=${MAIL_USERNAME}
MAIL_PASSWORD=${MAIL_PASSWORD}
MAIL_DEFAULT_SENDER=info@ogrencikoçluk.com
MAIL_SUPPRESS_SEND=false

# ------------------------------------------
# FILE STORAGE (S3)
# ------------------------------------------
STORAGE_TYPE=s3
MAX_CONTENT_LENGTH=52428800

AWS_ACCESS_KEY_ID=${AWS_ACCESS_KEY_ID}
AWS_SECRET_ACCESS_KEY=${AWS_SECRET_ACCESS_KEY}
AWS_S3_BUCKET=sks-production-uploads
AWS_S3_REGION=eu-central-1

# ------------------------------------------
# RATE LIMITING (Production - Strict)
# ------------------------------------------
RATELIMIT_ENABLED=true
RATELIMIT_DEFAULT=100/minute
RATELIMIT_LOGIN=5/minute
RATELIMIT_REGISTER=3/hour
RATELIMIT_PASSWORD_RESET=3/hour
RATELIMIT_API=1000/hour
RATELIMIT_UPLOAD=10/minute
RATELIMIT_STORAGE_URL=${REDIS_URL}
RATELIMIT_HEADERS_ENABLED=true

# ------------------------------------------
# LOGGING
# ------------------------------------------
LOG_LEVEL=WARNING
LOG_FORMAT=%(asctime)s - %(name)s - %(levelname)s - %(message)s
LOG_FILE=/var/log/sks/production.log
LOG_MAX_BYTES=10485760
LOG_BACKUP_COUNT=10

# ------------------------------------------
# MONITORING (Production - Full)
# ------------------------------------------
SENTRY_DSN=${SENTRY_DSN}
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1
SENTRY_PROFILES_SAMPLE_RATE=0.1

# Prometheus metrics
PROMETHEUS_ENABLED=true
PROMETHEUS_PORT=9090

# Health check
HEALTHCHECK_PATH=/health
HEALTHCHECK_TIMEOUT=5

# ------------------------------------------
# EXTERNAL SERVICES
# ------------------------------------------
YOUTUBE_API_KEY=${YOUTUBE_API_KEY}
ZOOM_API_KEY=${ZOOM_API_KEY}
ZOOM_API_SECRET=${ZOOM_API_SECRET}
GOOGLE_CLIENT_ID=${GOOGLE_CLIENT_ID}
GOOGLE_CLIENT_SECRET=${GOOGLE_CLIENT_SECRET}

# ------------------------------------------
# PAGINATION
# ------------------------------------------
DEFAULT_PAGE_SIZE=20
MAX_PAGE_SIZE=100

# ------------------------------------------
# FEATURE FLAGS
# ------------------------------------------
FEATURE_LIVE_CLASSES=true
FEATURE_VIDEO_UPLOAD=true
FEATURE_AI_RECOMMENDATIONS=false
